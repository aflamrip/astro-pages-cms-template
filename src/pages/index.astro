---
import Layout from '../layouts/Layout.astro';
import HeroSlider from '../components/HeroSlider.astro';
import MediaCard from '../components/MediaCard.astro';
import { getCollection } from 'astro:content';

const movies = await getCollection('movies');
const series = await getCollection('series');
const latestMovies = movies.sort((a, b) => b.data.year - a.data.year).slice(0, 10);
const latestSeries = series.sort((a, b) => b.data.year - a.data.year).slice(0, 10);
---

<Layout title="موقع الأفلام والمسلسلات">
  <HeroSlider />
  
  <section class="latest-section">
    <h2>أحدث الأفلام</h2>
    <div class="media-grid">
      {latestMovies.map((movie) => (
        <MediaCard 
          title={movie.data.title}
          poster={movie.data.poster}
          rating={movie.data.rating}
          href={`/movie/${movie.slug}/`}
          type="فيلم"
        />
      ))}
    </div>
  </section>

  <section class="latest-section">
    <h2>أحدث المسلسلات</h2>
    <div class="media-grid">
      {latestSeries.map((serie) => (
        <MediaCard 
          title={serie.data.title}
          poster={serie.data.poster}
          rating={serie.data.rating}
          href={`/series/${serie.slug}/`}
          type="مسلسل"
        />
      ))}
    </div>
  </section>
</Layout>
